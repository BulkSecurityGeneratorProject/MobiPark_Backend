<div class="alert alert-info">
    <p>Sort Type: {{ sortType }}</p>

    <p>Sort Order: {{ sortReverse == true ? 'DESC' : 'ASC' }}</p>

    <p>Search Query: {{ searchRecord }}</p>
</div>

<form>
    <div class="form-group">
        <div class="input-group">
            <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>
            <input type="text" class="form-control" placeholder="Search By Status" ng-model="searchRecord">
        </div>
    </div>
</form>

<table class="table table-bordered table-striped">

    <thead>
    <tr>
        <td>
            <a href="#" ng-click="sortType = 'id'; sortReverse = !sortReverse">
                ID
                <span ng-show="sortType == 'id' && !sortReverse" class="fa fa-caret-down"></span>
                <span ng-show="sortType == 'id' && sortReverse" class="fa fa-caret-up"></span>
            </a>
        </td>
        <td>
            <a href="#" ng-click="sortType = 'parkingStatus'; sortReverse = !sortReverse">
                Record Status
                <span ng-show="sortType == 'parkingStatus' && !sortReverse" class="fa fa-caret-down"></span>
                <span ng-show="sortType == 'parkingStatus' && sortReverse" class="fa fa-caret-up"></span>
            </a>
        </td>
        <td>
            Time in
        </td>
        <td>
            Time Out
        </td>
        <td>
            <a href="#" ng-click="sortType = 'entryDatetime.millis'; sortReverse = !sortReverse">
                License Plate
                <span ng-show="sortType == 'entryDatetime.millis' && !sortReverse" class="fa fa-caret-down"></span>
                <span ng-show="sortType == 'entryDatetime.millis' && sortReverse" class="fa fa-caret-up"></span>
            </a>
        </td>
        <td>
            Action
        </td>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="record in records | orderBy:sortType:sortReverse | filter:searchRecord">
        <td>{{record.id}}</td>
        <td>{{record.parkingStatus| limitTo: 20 }}{{record.parkingStatus.length > 20 ? '...' : ''}}</td>
        <td>{{record.entryDateTime.millis | date:'h:mma' }}</td>
        <td>{{record.exitDateTime.millis | date:'h:mma'}}</td>
        <td>{{record.userLicensePlate}}</td>
        <td>
            <button class="btn btn-sm btn-success" ng-click="openModal(record)">manage</button>
        </td>
    </tr>
    </tbody>
</table>

<script type="text/ng-template" id="transactionTemplate.html">
    <div class="modal-header">
        <h3 class="modal-title">Transaction: </h3>
    </div>
    <div class="modal-body">
        <b> Id: </b> {{record.id}} </br>
        <b> Status: </b>
        <span ng-show="status == 0" class="label label-sm label-primary">Ok</span>
        <span ng-show="status == 1" class="label label-sm label-warning">Pending</span>
        <span ng-show="status == 2" class="label label-sm label-success">Completed</span>
        <span ng-show="status == -1" class="label label-sm label-danger">Error</span>
        </br>
        </br>
        <b> Msg: </b> {{record.parkingStatus}}  </br>
        </br>
        <b> Email: </b> {{record.userEmail}} </br>
        <b> Phone Number: </b> {{record.userPhoneNumber}} </br>
        <b> License Plate: </b> {{record.userLicensePlate}} </br>
        <b> Payment Method: </b>  </br>
        <b> Subscription Date: </b> {{record.planSubscriptionDate.millis | date:"EEEE MMMM dd, yyyy 'at' h:mma" }} </br>
        <b> Plan: </b> {{record.planName}} </br>
        <b> Time in: </b> {{record.entryDateTime.millis | date:"EEEE MMMM dd, yyyy 'at' h:mma" }}</br>
        <b> Time Out: </b> {{record.exitDateTime.millis | date:"EEEE MMMM dd, yyyy 'at' h:mma" }}</br>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" ng-click="openGate()">Gate Operations</button>
        <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
    </div>
</script>


<script type="text/ng-template" id="openGateTemplate.html">
    <div class="modal-header">
        <h3 class="modal-title">Gate Operation For transaction id = {{record.id}} </h3>
    </div>
    <div class="modal-body">
        <div class="list-group">
            <h3> Access Questions </h3>
            <a href="#" class="list-group-item">
                <h4 class="list-group-item-heading">What is your primary mobile phone number?</h4>

                <p class="list-group-item-text">{{record.userPhoneNumber}}</p>
            </a>
            <a href="#" class="list-group-item">
                <h4 class="list-group-item-heading">What is your primary vehicle license plate number?</h4>

                <p class="list-group-item-text">{{record.userLicensePlate}}</p>
            </a>
            <a href="#" class="list-group-item">
                <h4 class="list-group-item-heading">What is your email Address?</h4>

                <p class="list-group-item-text">{{record.userEmail}}</p>
            </a>
            <a href="#" class="list-group-item">
                <h4 class="list-group-item-heading">What is Subscription plan type?</h4>

                <p class="list-group-item-text">{{record.planName}}</p>
            </a>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" ng-click="open()">Open Gate</button>
        <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
    </div>
</script>
